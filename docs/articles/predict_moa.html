<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Predict compounds mechanism-of-action by morphological profiling â€¢ cytominergallery</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Predict compounds mechanism-of-action by morphological profiling">
<meta property="og:description" content="cytominergallery">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cytominergallery</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/predict_moa.html">Predict compounds mechanism-of-action by morphological profiling</a>
    </li>
    <li>
      <a href="../articles/predict_moa_using_snf.html">Improving predicting compounds mechanism-of-action by morphological profiling using SNF</a>
    </li>
    <li>
      <a href="../articles/single_cell_analysis.html">Analyze single-cell data</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/cytomining/cytominergallery/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="predict_moa_files/header-attrs-2.1/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Predict compounds mechanism-of-action by morphological profiling</h1>
                        <h4 class="author">Allen Goodman and Shantanu Singh</h4>
            
            <h4 class="date">2020-04-29</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/cytomining/cytominergallery/blob/master/vignettes/predict_moa.Rmd"><code>vignettes/predict_moa.Rmd</code></a></small>
      <div class="hidden name"><code>predict_moa.Rmd</code></div>

    </div>

    
    
<p>This vignette demonstrates predicting compound mechanism-of-action using morphological profiling data. See the vignette <code>single_cell_analysis</code> for details about this dataset.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">magrittr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">stringr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">cytominergallery</span>)</pre></body></html></div>
<div id="load-data" class="section level1">
<h1 class="hasAnchor">
<a href="#load-data" class="anchor"></a>Load data</h1>
<p>Per-well profiles computed in <code>single_cell_analysis</code> are loaded, as well as metadata associated with these profiles (obtained from <a href="https://data.broadinstitute.org/bbbc/BBBC021/">BBBC021</a>)</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">profiles</span> <span class="kw">&lt;-</span>
  <span class="kw pkg">readr</span><span class="kw ns">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>, <span class="st">"ljosa_jbiomolscreen_2013_per_well_mean.csv"</span>,
                <span class="kw">package</span> <span class="kw">=</span> <span class="st">"cytominergallery"</span>))

<span class="no">moa</span> <span class="kw">&lt;-</span>
  <span class="kw pkg">readr</span><span class="kw ns">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>, <span class="st">"BBBC021_v1_moa.csv"</span>,
                              <span class="kw">package</span> <span class="kw">=</span> <span class="st">"cytominergallery"</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">rename</a></span>(<span class="kw">Image_Metadata_Compound</span> <span class="kw">=</span> <span class="no">compound</span>,
                <span class="kw">Image_Metadata_Concentration</span> <span class="kw">=</span> <span class="no">concentration</span>,
                <span class="kw">Image_Metadata_MoA</span> <span class="kw">=</span> <span class="no">moa</span>
  )

<span class="no">metadata</span> <span class="kw">&lt;-</span>
  <span class="kw pkg">readr</span><span class="kw ns">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>, <span class="st">"BBBC021_v1_image.csv"</span>,
                              <span class="kw">package</span> <span class="kw">=</span> <span class="st">"cytominergallery"</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">rename</a></span>(<span class="kw">Image_Metadata_Plate</span> <span class="kw">=</span> <span class="no">Image_Metadata_Plate_DAPI</span>,
                <span class="kw">Image_Metadata_Well</span> <span class="kw">=</span> <span class="no">Image_Metadata_Well_DAPI</span>
  ) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="fu"><a href="https://dplyr.tidyverse.org/reference/reexports.html">matches</a></span>(<span class="st">"^Image_Metadata"</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/join.html">inner_join</a></span>(<span class="no">moa</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span>()

<span class="no">profiles</span> <span class="kw">%&lt;&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/join.html">inner_join</a></span>(<span class="no">metadata</span>)

<span class="no">variables</span> <span class="kw">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">profiles</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_subset.html">str_subset</a></span>(<span class="st">"^Nuclei_|^Cells_|^Cytoplasm_"</span>)</pre></body></html></div>
<p>How many compounds?</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">profiles</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">Image_Metadata_Compound</span> <span class="kw">!=</span> <span class="st">"DMSO"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span>(<span class="no">Image_Metadata_Compound</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/tally.html">tally</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">rename</a></span>(<span class="kw">`Number of compounds`</span> <span class="kw">=</span> <span class="no">n</span>) <span class="kw">%&gt;%</span>
  <span class="kw pkg">knitr</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>()</pre></body></html></div>
<table class="table">
<thead><tr class="header">
<th align="right">Number of compounds</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">38</td>
</tr></tbody>
</table>
<p>How many unique treatments (compound-concentration pairs)?</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">profiles</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">Image_Metadata_Compound</span> <span class="kw">!=</span> <span class="st">"DMSO"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span>(<span class="no">Image_Metadata_Compound</span>, <span class="no">Image_Metadata_Concentration</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/tally.html">tally</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">rename</a></span>(<span class="kw">`Number of unique treatments`</span> <span class="kw">=</span> <span class="no">n</span>) <span class="kw">%&gt;%</span>
  <span class="kw pkg">knitr</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>()</pre></body></html></div>
<table class="table">
<thead><tr class="header">
<th align="right">Number of unique treatments</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">103</td>
</tr></tbody>
</table>
<p>How many replicates per unique treatment?</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">profiles</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">Image_Metadata_Compound</span> <span class="kw">!=</span> <span class="st">"DMSO"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/tally.html">count</a></span>(<span class="no">Image_Metadata_Compound</span>, <span class="no">Image_Metadata_Concentration</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">rename</a></span>(<span class="kw">`Number of replicates`</span> <span class="kw">=</span> <span class="no">n</span>) <span class="kw">%&gt;%</span>
  <span class="kw pkg">knitr</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>()</pre></body></html></div>
<table class="table">
<thead><tr class="header">
<th align="left">Image_Metadata_Compound</th>
<th align="right">Image_Metadata_Concentration</th>
<th align="right">Number of replicates</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">ALLN</td>
<td align="right">3.000</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">ALLN</td>
<td align="right">100.000</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">alsterpaullone</td>
<td align="right">1.000</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">alsterpaullone</td>
<td align="right">3.000</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">anisomycin</td>
<td align="right">0.300</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">anisomycin</td>
<td align="right">1.000</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">AZ-A</td>
<td align="right">0.100</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">AZ-A</td>
<td align="right">0.300</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">AZ-A</td>
<td align="right">1.000</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">AZ-A</td>
<td align="right">3.000</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">AZ-A</td>
<td align="right">10.000</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">AZ-A</td>
<td align="right">30.000</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">AZ-C</td>
<td align="right">0.001</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">AZ-C</td>
<td align="right">0.003</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">AZ-C</td>
<td align="right">0.010</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">AZ-C</td>
<td align="right">0.030</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">AZ-C</td>
<td align="right">0.100</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">AZ-C</td>
<td align="right">0.300</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">AZ-C</td>
<td align="right">1.000</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">AZ-J</td>
<td align="right">1.000</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">AZ-J</td>
<td align="right">3.000</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">AZ-J</td>
<td align="right">10.000</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">AZ-U</td>
<td align="right">1.000</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">AZ-U</td>
<td align="right">3.000</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">AZ-U</td>
<td align="right">10.000</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">AZ138</td>
<td align="right">0.030</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">AZ138</td>
<td align="right">0.100</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">AZ138</td>
<td align="right">0.300</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">AZ138</td>
<td align="right">1.000</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">AZ138</td>
<td align="right">3.000</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">AZ258</td>
<td align="right">0.100</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">AZ258</td>
<td align="right">0.300</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">AZ258</td>
<td align="right">1.000</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">AZ841</td>
<td align="right">0.100</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">AZ841</td>
<td align="right">0.300</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">AZ841</td>
<td align="right">1.000</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">bryostatin</td>
<td align="right">0.300</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">camptothecin</td>
<td align="right">0.003</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">camptothecin</td>
<td align="right">0.010</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">camptothecin</td>
<td align="right">0.030</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">chlorambucil</td>
<td align="right">10.000</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">cisplatin</td>
<td align="right">10.000</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">colchicine</td>
<td align="right">0.030</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">cyclohexamide</td>
<td align="right">5.000</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">cyclohexamide</td>
<td align="right">15.000</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">cyclohexamide</td>
<td align="right">50.000</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">cytochalasin B</td>
<td align="right">10.000</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">cytochalasin B</td>
<td align="right">30.000</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">cytochalasin D</td>
<td align="right">0.300</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">demecolcine</td>
<td align="right">0.300</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">demecolcine</td>
<td align="right">1.000</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">demecolcine</td>
<td align="right">3.000</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">demecolcine</td>
<td align="right">10.000</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">docetaxel</td>
<td align="right">0.030</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">docetaxel</td>
<td align="right">0.100</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">docetaxel</td>
<td align="right">0.300</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">emetine</td>
<td align="right">0.100</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">emetine</td>
<td align="right">0.300</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">emetine</td>
<td align="right">1.000</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">epothilone B</td>
<td align="right">0.100</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">epothilone B</td>
<td align="right">0.300</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">epothilone B</td>
<td align="right">1.000</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">etoposide</td>
<td align="right">1.000</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">etoposide</td>
<td align="right">3.000</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">etoposide</td>
<td align="right">10.000</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">floxuridine</td>
<td align="right">10.000</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">floxuridine</td>
<td align="right">30.000</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">lactacystin</td>
<td align="right">10.000</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">latrunculin B</td>
<td align="right">1.000</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">latrunculin B</td>
<td align="right">3.000</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">methotrexate</td>
<td align="right">10.000</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">mevinolin/lovastatin</td>
<td align="right">1.500</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">mevinolin/lovastatin</td>
<td align="right">5.000</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">mevinolin/lovastatin</td>
<td align="right">15.000</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">MG-132</td>
<td align="right">0.100</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">MG-132</td>
<td align="right">3.000</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">mitomycin C</td>
<td align="right">0.100</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">mitomycin C</td>
<td align="right">0.300</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">mitomycin C</td>
<td align="right">1.000</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">mitomycin C</td>
<td align="right">3.000</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">mitoxantrone</td>
<td align="right">0.003</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">mitoxantrone</td>
<td align="right">0.010</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">nocodazole</td>
<td align="right">1.000</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">nocodazole</td>
<td align="right">3.000</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">PD-169316</td>
<td align="right">3.000</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">PD-169316</td>
<td align="right">10.000</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">PP-2</td>
<td align="right">3.000</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">PP-2</td>
<td align="right">10.000</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">proteasome inhibitor I</td>
<td align="right">0.100</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">proteasome inhibitor I</td>
<td align="right">3.000</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">simvastatin</td>
<td align="right">2.000</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">simvastatin</td>
<td align="right">6.000</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">simvastatin</td>
<td align="right">20.000</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">taxol</td>
<td align="right">0.300</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">taxol</td>
<td align="right">1.000</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">taxol</td>
<td align="right">3.000</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">vincristine</td>
<td align="right">0.003</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">vincristine</td>
<td align="right">0.010</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">vincristine</td>
<td align="right">0.030</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">vincristine</td>
<td align="right">0.100</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">vincristine</td>
<td align="right">0.300</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">vincristine</td>
<td align="right">1.000</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">vincristine</td>
<td align="right">3.000</td>
<td align="right">3</td>
</tr>
</tbody>
</table>
<p>How many DMSO wells per plate?</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">profiles</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">Image_Metadata_Compound</span> <span class="kw">==</span> <span class="st">"DMSO"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/tally.html">count</a></span>(<span class="no">Image_Metadata_Plate</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">rename</a></span>(<span class="kw">`Number of DMSO wells`</span> <span class="kw">=</span> <span class="no">n</span>) <span class="kw">%&gt;%</span>
  <span class="kw pkg">knitr</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>()</pre></body></html></div>
<table class="table">
<thead><tr class="header">
<th align="left">Image_Metadata_Plate</th>
<th align="right">Number of DMSO wells</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Week1_22123</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="left">Week1_22141</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="left">Week1_22161</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="left">Week1_22361</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="left">Week1_22381</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="left">Week1_22401</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="left">Week10_40111</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="left">Week10_40115</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="left">Week10_40119</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="left">Week2_24121</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="left">Week2_24141</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="left">Week2_24161</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="left">Week2_24361</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="left">Week2_24381</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="left">Week2_24401</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="left">Week3_25421</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="left">Week3_25441</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="left">Week3_25461</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="left">Week3_25681</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="left">Week3_25701</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="left">Week3_25721</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="left">Week4_27481</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="left">Week4_27521</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="left">Week4_27542</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="left">Week4_27801</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="left">Week4_27821</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="left">Week4_27861</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="left">Week5_28901</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="left">Week5_28921</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="left">Week5_28961</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="left">Week5_29301</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="left">Week5_29321</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="left">Week5_29341</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="left">Week6_31641</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="left">Week6_31661</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="left">Week6_31681</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="left">Week6_32061</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="left">Week6_32121</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="left">Week6_32161</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="left">Week7_34341</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="left">Week7_34381</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="left">Week7_34641</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="left">Week7_34661</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="left">Week7_34681</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="left">Week8_38203</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="left">Week8_38221</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="left">Week8_38241</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="left">Week8_38341</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="left">Week8_38342</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="left">Week9_39206</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="left">Week9_39221</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="left">Week9_39222</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="left">Week9_39282</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="left">Week9_39283</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="left">Week9_39301</td>
<td align="right">6</td>
</tr>
</tbody>
</table>
</div>
<div id="feature-selection" class="section level1">
<h1 class="hasAnchor">
<a href="#feature-selection" class="anchor"></a>Feature selection</h1>
<p>Next, lets filter the set of features based on various measures of quality</p>
<p>Remove features that have near-zero variance. This dataset doesnâ€™t have any such features, so nothing is removed.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">profiles</span> <span class="kw">&lt;-</span>
  <span class="kw pkg">cytominer</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/cytominer/man/variable_select.html">variable_select</a></span>(
    <span class="kw">population</span> <span class="kw">=</span> <span class="no">profiles</span>,
    <span class="kw">variables</span> <span class="kw">=</span> <span class="no">variables</span>,
    <span class="kw">sample</span> <span class="kw">=</span> <span class="no">profiles</span>,
    <span class="kw">operation</span> <span class="kw">=</span> <span class="st">"variance_threshold"</span>
  ) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html">collect</a></span>()

<span class="no">variables</span> <span class="kw">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">profiles</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_subset.html">str_subset</a></span>(<span class="st">"^Nuclei_|^Cells_|^Cytoplasm_"</span>)</pre></body></html></div>
<p>Remove features that have poor correlation across replicates. To do so, lets first compute the correlations.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="kw pkg">doParallel</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/doParallel/man/registerDoParallel.html">registerDoParallel</a></span>(<span class="kw">cores</span> <span class="kw">=</span> <span class="fl">2</span>)

<span class="no">feature_replicate_correlations</span> <span class="kw">&lt;-</span>
  <span class="no">profiles</span> <span class="kw">%&gt;%</span>
  <span class="kw pkg">cytominer</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/cytominer/man/variable_importance.html">variable_importance</a></span>(
    <span class="kw">variables</span> <span class="kw">=</span> <span class="no">variables</span>,
    <span class="kw">strata</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Image_Metadata_Compound"</span>, <span class="st">"Image_Metadata_Concentration"</span>),
    <span class="kw">replicates</span> <span class="kw">=</span> <span class="fl">3</span>,
    <span class="kw">cores</span> <span class="kw">=</span> <span class="fl">2</span>)</pre></body></html></div>
<p>What the does the distribution look like?</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="no">feature_replicate_correlations</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">median</span>))  +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_ecdf.html">stat_ecdf</a></span>() +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span>(<span class="kw">xintercept</span> <span class="kw">=</span> <span class="fl">0.5</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"red"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span>(<span class="st">"median replicate correlation (Pearson)"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span>(<span class="st">"F(x)"</span>)</pre></body></html></div>
<p><img src="predict_moa_files/figure-html/unnamed-chunk-8-1.png" width="384"></p>
<p>Here, we select a threshold and remove features that have a replicate correlation lower than that threshold</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="no">profiles</span> <span class="kw">%&lt;&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/se-deprecated.html">select_</a></span>(<span class="kw">.dots</span> <span class="kw">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/setops.html">setdiff</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">profiles</span>),
                          <span class="kw">y</span> <span class="kw">=</span> <span class="no">feature_replicate_correlations</span> <span class="kw">%&gt;%</span>
                            <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">median</span> <span class="kw">&lt;</span> <span class="fl">0.5</span>) <span class="kw">%&gt;%</span>
                            <span class="kw pkg">magrittr</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/magrittr/man/aliases.html">extract2</a></span>(<span class="st">"variable"</span>))
          )</pre></body></html></div>
<pre><code>## Warning: select_() is deprecated. 
## Please use select() instead
## 
## The 'programming' vignette or the tidyeval book can help you
## to program with select() : https://tidyeval.tidyverse.org
## This warning is displayed once per session.</code></pre>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="no">variables</span> <span class="kw">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">profiles</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_subset.html">str_subset</a></span>(<span class="st">"^Nuclei_|^Cells_|^Cytoplasm_"</span>)</pre></body></html></div>
<p>Filter based on correlation between features. The morphological features extracted contain several highly correlated groups. We want to to prune the set of features, retaining only one feature from each of these highly correlated sets. The function <code>correlation_threshold</code> provides an approximate (greedy) solution to this problem. After excluding the features, no pair of features have a correlation greater than <code>cutoff</code> indicated below.</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="no">profiles</span> <span class="kw">&lt;-</span>
  <span class="kw pkg">cytominer</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/cytominer/man/variable_select.html">variable_select</a></span>(
    <span class="kw">population</span> <span class="kw">=</span> <span class="no">profiles</span>,
    <span class="kw">variables</span> <span class="kw">=</span> <span class="no">variables</span>,
    <span class="kw">sample</span> <span class="kw">=</span> <span class="no">profiles</span>,
    <span class="kw">operation</span> <span class="kw">=</span> <span class="st">"correlation_threshold"</span>,
    <span class="kw">cutoff</span> <span class="kw">=</span> <span class="fl">0.95</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html">collect</a></span>()</pre></body></html></div>
<pre><code>## INFO [2020-04-29 13:46:03] excluded:
## INFO [2020-04-29 13:46:03]    Cells_AreaShape_MaximumRadius
## INFO [2020-04-29 13:46:03]    Cells_AreaShape_MeanRadius
## INFO [2020-04-29 13:46:03]    Cells_AreaShape_MedianRadius
## INFO [2020-04-29 13:46:03]    Cells_AreaShape_MinFeretDiameter
## INFO [2020-04-29 13:46:03]    Cells_AreaShape_MinorAxisLength
## INFO [2020-04-29 13:46:03]    Cells_Intensity_MaxIntensity_CorrActin
## INFO [2020-04-29 13:46:03]    Cells_Intensity_MaxIntensity_CorrTub
## INFO [2020-04-29 13:46:03]    Cells_Intensity_MeanIntensityEdge_CorrTub
## INFO [2020-04-29 13:46:03]    Cells_Intensity_MeanIntensity_CorrActin
## INFO [2020-04-29 13:46:03]    Cells_Intensity_MeanIntensity_CorrTub
## INFO [2020-04-29 13:46:03]    Cells_Intensity_MedianIntensity_CorrActin
## INFO [2020-04-29 13:46:03]    Cells_Intensity_MedianIntensity_CorrTub
## INFO [2020-04-29 13:46:03]    Cells_Intensity_MinIntensity_CorrActin
## INFO [2020-04-29 13:46:03]    Cells_Intensity_StdIntensityEdge_CorrActin
## INFO [2020-04-29 13:46:03]    Cells_Intensity_StdIntensityEdge_CorrTub
## INFO [2020-04-29 13:46:03]    Cells_Intensity_StdIntensity_CorrActin
## INFO [2020-04-29 13:46:03]    Cells_Intensity_StdIntensity_CorrTub
## INFO [2020-04-29 13:46:03]    Cells_Intensity_UpperQuartileIntensity_CorrActin
## INFO [2020-04-29 13:46:03]    Cells_Intensity_UpperQuartileIntensity_CorrTub
## INFO [2020-04-29 13:46:03]    Cells_Neighbors_NumberOfNeighbors_3
## INFO [2020-04-29 13:46:03]    Cells_Texture_SumVariance_CorrActin_3_0
## INFO [2020-04-29 13:46:03]    Cells_Texture_Variance_CorrActin_10_0
## INFO [2020-04-29 13:46:03]    Cells_Texture_Variance_CorrActin_3_0
## INFO [2020-04-29 13:46:03]    Cells_Texture_Variance_CorrTub_10_0
## INFO [2020-04-29 13:46:03]    Cytoplasm_AreaShape_Area
## INFO [2020-04-29 13:46:03]    Cytoplasm_AreaShape_MajorAxisLength
## INFO [2020-04-29 13:46:03]    Cytoplasm_AreaShape_MaxFeretDiameter
## INFO [2020-04-29 13:46:03]    Cytoplasm_AreaShape_MaximumRadius
## INFO [2020-04-29 13:46:03]    Cytoplasm_AreaShape_MeanRadius
## INFO [2020-04-29 13:46:03]    Cytoplasm_AreaShape_MedianRadius
## INFO [2020-04-29 13:46:03]    Cytoplasm_AreaShape_MinFeretDiameter
## INFO [2020-04-29 13:46:03]    Cytoplasm_AreaShape_MinorAxisLength
## INFO [2020-04-29 13:46:03]    Cytoplasm_AreaShape_Solidity
## INFO [2020-04-29 13:46:03]    Cytoplasm_AreaShape_Zernike_0_0
## INFO [2020-04-29 13:46:03]    Cytoplasm_Intensity_IntegratedIntensityEdge_CorrActin
## INFO [2020-04-29 13:46:03]    Cytoplasm_Intensity_IntegratedIntensityEdge_CorrTub
## INFO [2020-04-29 13:46:03]    Cytoplasm_Intensity_IntegratedIntensity_CorrTub
## INFO [2020-04-29 13:46:03]    Cytoplasm_Intensity_MADIntensity_CorrActin
## INFO [2020-04-29 13:46:03]    Cytoplasm_Intensity_MADIntensity_CorrTub
## INFO [2020-04-29 13:46:03]    Cytoplasm_Intensity_MassDisplacement_CorrActin
## INFO [2020-04-29 13:46:03]    Cytoplasm_Intensity_MassDisplacement_CorrTub
## INFO [2020-04-29 13:46:03]    Cytoplasm_Intensity_MaxIntensityEdge_CorrActin
## INFO [2020-04-29 13:46:03]    Cytoplasm_Intensity_MaxIntensity_CorrActin
## INFO [2020-04-29 13:46:03]    Cytoplasm_Intensity_MaxIntensity_CorrTub
## INFO [2020-04-29 13:46:03]    Cytoplasm_Intensity_MeanIntensityEdge_CorrActin
## INFO [2020-04-29 13:46:03]    Cytoplasm_Intensity_MeanIntensityEdge_CorrTub
## INFO [2020-04-29 13:46:03]    Cytoplasm_Intensity_MeanIntensity_CorrActin
## INFO [2020-04-29 13:46:03]    Cytoplasm_Intensity_MeanIntensity_CorrTub
## INFO [2020-04-29 13:46:03]    Cytoplasm_Intensity_MedianIntensity_CorrActin
## INFO [2020-04-29 13:46:03]    Cytoplasm_Intensity_MedianIntensity_CorrTub
## INFO [2020-04-29 13:46:03]    Cytoplasm_Intensity_MinIntensityEdge_CorrActin
## INFO [2020-04-29 13:46:03]    Cytoplasm_Intensity_MinIntensityEdge_CorrTub
## INFO [2020-04-29 13:46:03]    Cytoplasm_Intensity_MinIntensity_CorrActin
## INFO [2020-04-29 13:46:03]    Cytoplasm_Intensity_MinIntensity_CorrTub
## INFO [2020-04-29 13:46:03]    Cytoplasm_Intensity_StdIntensityEdge_CorrActin
## INFO [2020-04-29 13:46:03]    Cytoplasm_Intensity_StdIntensityEdge_CorrTub
## INFO [2020-04-29 13:46:03]    Cytoplasm_Intensity_StdIntensity_CorrActin
## INFO [2020-04-29 13:46:03]    Cytoplasm_Intensity_StdIntensity_CorrTub
## INFO [2020-04-29 13:46:03]    Cytoplasm_Intensity_UpperQuartileIntensity_CorrActin
## INFO [2020-04-29 13:46:03]    Cytoplasm_Intensity_UpperQuartileIntensity_CorrTub
## INFO [2020-04-29 13:46:03]    Cytoplasm_Texture_DifferenceEntropy_CorrActin_3_0
## INFO [2020-04-29 13:46:03]    Cytoplasm_Texture_DifferenceVariance_CorrTub_10_0
## INFO [2020-04-29 13:46:03]    Cytoplasm_Texture_DifferenceVariance_CorrTub_3_0
## INFO [2020-04-29 13:46:03]    Cytoplasm_Texture_InfoMeas2_CorrActin_3_0
## INFO [2020-04-29 13:46:03]    Cytoplasm_Texture_SumAverage_CorrTub_3_0
## INFO [2020-04-29 13:46:03]    Cytoplasm_Texture_Variance_CorrTub_10_0
## INFO [2020-04-29 13:46:03]    Nuclei_AreaShape_MajorAxisLength
## INFO [2020-04-29 13:46:03]    Nuclei_AreaShape_MaxFeretDiameter
## INFO [2020-04-29 13:46:03]    Nuclei_AreaShape_MeanRadius
## INFO [2020-04-29 13:46:03]    Nuclei_AreaShape_MinorAxisLength
## INFO [2020-04-29 13:46:03]    Nuclei_AreaShape_Perimeter
## INFO [2020-04-29 13:46:03]    Nuclei_AreaShape_Zernike_3_3
## INFO [2020-04-29 13:46:03]    Nuclei_AreaShape_Zernike_4_4
## INFO [2020-04-29 13:46:03]    Nuclei_AreaShape_Zernike_5_3
## INFO [2020-04-29 13:46:03]    Nuclei_AreaShape_Zernike_6_6
## INFO [2020-04-29 13:46:03]    Nuclei_AreaShape_Zernike_7_3
## INFO [2020-04-29 13:46:03]    Nuclei_AreaShape_Zernike_7_5
## INFO [2020-04-29 13:46:03]    Nuclei_AreaShape_Zernike_7_7
## INFO [2020-04-29 13:46:03]    Nuclei_AreaShape_Zernike_9_7
## INFO [2020-04-29 13:46:03]    Nuclei_AreaShape_Zernike_9_9
## INFO [2020-04-29 13:46:03]    Nuclei_Intensity_IntegratedIntensityEdge_CorrActin
## INFO [2020-04-29 13:46:03]    Nuclei_Intensity_IntegratedIntensityEdge_CorrTub
## INFO [2020-04-29 13:46:03]    Nuclei_Intensity_IntegratedIntensity_CorrActin
## INFO [2020-04-29 13:46:03]    Nuclei_Intensity_IntegratedIntensity_CorrTub
## INFO [2020-04-29 13:46:03]    Nuclei_Intensity_LowerQuartileIntensity_CorrActin
## INFO [2020-04-29 13:46:03]    Nuclei_Intensity_LowerQuartileIntensity_CorrTub
## INFO [2020-04-29 13:46:03]    Nuclei_Intensity_MADIntensity_CorrActin
## INFO [2020-04-29 13:46:03]    Nuclei_Intensity_MADIntensity_CorrTub
## INFO [2020-04-29 13:46:03]    Nuclei_Intensity_MaxIntensityEdge_CorrActin
## INFO [2020-04-29 13:46:03]    Nuclei_Intensity_MaxIntensityEdge_CorrTub
## INFO [2020-04-29 13:46:03]    Nuclei_Intensity_MaxIntensity_CorrActin
## INFO [2020-04-29 13:46:03]    Nuclei_Intensity_MaxIntensity_CorrTub
## INFO [2020-04-29 13:46:03]    Nuclei_Intensity_MeanIntensityEdge_CorrActin
## INFO [2020-04-29 13:46:03]    Nuclei_Intensity_MeanIntensityEdge_CorrDAPI
## INFO [2020-04-29 13:46:03]    Nuclei_Intensity_MeanIntensityEdge_CorrTub
## INFO [2020-04-29 13:46:03]    Nuclei_Intensity_MeanIntensity_CorrActin
## INFO [2020-04-29 13:46:03]    Nuclei_Intensity_MeanIntensity_CorrDAPI
## INFO [2020-04-29 13:46:03]    Nuclei_Intensity_MeanIntensity_CorrTub
## INFO [2020-04-29 13:46:03]    Nuclei_Intensity_MedianIntensity_CorrActin
## INFO [2020-04-29 13:46:03]    Nuclei_Intensity_MedianIntensity_CorrDAPI
## INFO [2020-04-29 13:46:03]    Nuclei_Intensity_MedianIntensity_CorrTub
## INFO [2020-04-29 13:46:03]    Nuclei_Intensity_MinIntensityEdge_CorrActin
## INFO [2020-04-29 13:46:03]    Nuclei_Intensity_MinIntensityEdge_CorrDAPI
## INFO [2020-04-29 13:46:03]    Nuclei_Intensity_MinIntensity_CorrActin
## INFO [2020-04-29 13:46:03]    Nuclei_Intensity_MinIntensity_CorrDAPI
## INFO [2020-04-29 13:46:03]    Nuclei_Intensity_MinIntensity_CorrTub
## INFO [2020-04-29 13:46:03]    Nuclei_Intensity_StdIntensityEdge_CorrActin
## INFO [2020-04-29 13:46:03]    Nuclei_Intensity_StdIntensity_CorrActin
## INFO [2020-04-29 13:46:03]    Nuclei_Intensity_StdIntensity_CorrDAPI
## INFO [2020-04-29 13:46:03]    Nuclei_Intensity_StdIntensity_CorrTub
## INFO [2020-04-29 13:46:03]    Nuclei_Intensity_UpperQuartileIntensity_CorrActin
## INFO [2020-04-29 13:46:03]    Nuclei_Intensity_UpperQuartileIntensity_CorrDAPI
## INFO [2020-04-29 13:46:03]    Nuclei_Intensity_UpperQuartileIntensity_CorrTub
## INFO [2020-04-29 13:46:03]    Nuclei_Neighbors_PercentTouching_10
## INFO [2020-04-29 13:46:03]    Nuclei_Texture_InfoMeas2_CorrDAPI_3_0
## INFO [2020-04-29 13:46:03]    Nuclei_Texture_Variance_CorrDAPI_3_0
## INFO [2020-04-29 13:46:03]    Cells_AreaShape_Area
## INFO [2020-04-29 13:46:03]    Cells_AreaShape_MajorAxisLength
## INFO [2020-04-29 13:46:03]    Cells_AreaShape_MaxFeretDiameter
## INFO [2020-04-29 13:46:04]    Cells_Intensity_LowerQuartileIntensity_CorrActin
## INFO [2020-04-29 13:46:04]    Cells_Intensity_MADIntensity_CorrTub
## INFO [2020-04-29 13:46:04]    Cells_Intensity_MaxIntensityEdge_CorrTub
## INFO [2020-04-29 13:46:04]    Cells_Intensity_MinIntensityEdge_CorrTub
## INFO [2020-04-29 13:46:04]    Cells_Intensity_MADIntensity_CorrActin
## INFO [2020-04-29 13:46:04]    Cells_Neighbors_AngleBetweenNeighbors_10
## INFO [2020-04-29 13:46:04]    Cells_Neighbors_FirstClosestDistance_10
## INFO [2020-04-29 13:46:04]    Cells_Neighbors_NumberOfNeighbors_10
## INFO [2020-04-29 13:46:04]    Cells_Neighbors_SecondClosestDistance_10
## INFO [2020-04-29 13:46:04]    Cells_Texture_Contrast_CorrTub_10_0
## INFO [2020-04-29 13:46:04]    Cells_Texture_InfoMeas1_CorrActin_3_0
## INFO [2020-04-29 13:46:04]    Cells_Texture_SumVariance_CorrTub_3_0
## INFO [2020-04-29 13:46:04]    Cytoplasm_AreaShape_Extent
## INFO [2020-04-29 13:46:04]    Cells_AreaShape_Perimeter
## INFO [2020-04-29 13:46:04]    Cells_Intensity_IntegratedIntensity_CorrActin
## INFO [2020-04-29 13:46:04]    Cells_Intensity_MeanIntensityEdge_CorrActin
## INFO [2020-04-29 13:46:04]    Cells_Intensity_LowerQuartileIntensity_CorrTub
## INFO [2020-04-29 13:46:04]    Cytoplasm_Intensity_MaxIntensityEdge_CorrTub
## INFO [2020-04-29 13:46:04]    Cells_Intensity_MaxIntensityEdge_CorrActin
## INFO [2020-04-29 13:46:04]    Cells_Texture_AngularSecondMoment_CorrTub_3_0
## INFO [2020-04-29 13:46:04]    Cells_Texture_Contrast_CorrActin_10_0
## INFO [2020-04-29 13:46:04]    Cells_Texture_DifferenceVariance_CorrActin_10_0
## INFO [2020-04-29 13:46:04]    Cells_Texture_DifferenceEntropy_CorrActin_3_0
## INFO [2020-04-29 13:46:04]    Cytoplasm_Texture_AngularSecondMoment_CorrTub_10_0
## INFO [2020-04-29 13:46:04]    Nuclei_AreaShape_MaximumRadius
## INFO [2020-04-29 13:46:04]    Nuclei_AreaShape_MedianRadius
## INFO [2020-04-29 13:46:04]    Nuclei_AreaShape_Zernike_3_1
## INFO [2020-04-29 13:46:04]    Nuclei_AreaShape_Zernike_5_5
## INFO [2020-04-29 13:46:04]    Nuclei_Intensity_MADIntensity_CorrDAPI
## INFO [2020-04-29 13:46:04]    Nuclei_Intensity_MaxIntensityEdge_CorrDAPI
## INFO [2020-04-29 13:46:04]    Nuclei_Intensity_MaxIntensity_CorrDAPI
## INFO [2020-04-29 13:46:04]    Cells_Neighbors_AngleBetweenNeighbors_3
## INFO [2020-04-29 13:46:04]    Nuclei_Neighbors_AngleBetweenNeighbors_10
## INFO [2020-04-29 13:46:04]    Cells_Neighbors_FirstClosestDistance_3
## INFO [2020-04-29 13:46:04]    Nuclei_Neighbors_FirstClosestDistance_10
## INFO [2020-04-29 13:46:04]    Cells_Neighbors_SecondClosestDistance_3
## INFO [2020-04-29 13:46:04]    Nuclei_Neighbors_SecondClosestDistance_10
## INFO [2020-04-29 13:46:04]    Nuclei_Texture_AngularSecondMoment_CorrActin_3_0
## INFO [2020-04-29 13:46:04]    Nuclei_Texture_InfoMeas1_CorrActin_10_0
## INFO [2020-04-29 13:46:04]    Nuclei_Texture_InfoMeas1_CorrActin_3_0
## INFO [2020-04-29 13:46:04]    Nuclei_Texture_InfoMeas1_CorrTub_3_0</code></pre>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="no">variables</span> <span class="kw">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">profiles</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_subset.html">str_subset</a></span>(<span class="st">"^Nuclei_|^Cells_|^Cytoplasm_"</span>)</pre></body></html></div>
</div>
<div id="normalize-with-reference-to-dmso" class="section level1">
<h1 class="hasAnchor">
<a href="#normalize-with-reference-to-dmso" class="anchor"></a>Normalize with reference to DMSO</h1>
<p>There may be plate-to-plate variations, which can be compensated for to some extent by normalizing the features with respect to the DMSO wells per plate.</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="no">profiles</span> <span class="kw">&lt;-</span>
  <span class="kw pkg">cytominer</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/cytominer/man/normalize.html">normalize</a></span>(
    <span class="kw">population</span> <span class="kw">=</span> <span class="no">profiles</span>,
    <span class="kw">variables</span> <span class="kw">=</span> <span class="no">variables</span>,
    <span class="kw">strata</span> <span class="kw">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Image_Metadata_Plate"</span>),
    <span class="kw">sample</span> <span class="kw">=</span> <span class="no">profiles</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">Image_Metadata_Compound</span> <span class="kw">==</span> <span class="st">"DMSO"</span>)
  )

<span class="no">profiles</span> <span class="kw">&lt;-</span>
  <span class="kw pkg">cytominer</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/cytominer/man/variable_select.html">variable_select</a></span>(
      <span class="kw">population</span> <span class="kw">=</span> <span class="no">profiles</span>,
      <span class="kw">variables</span> <span class="kw">=</span> <span class="no">variables</span>,
      <span class="kw">operation</span> <span class="kw">=</span> <span class="st">"drop_na_columns"</span>
  )

<span class="no">variables</span> <span class="kw">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">profiles</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_subset.html">str_subset</a></span>(<span class="st">"^Nuclei_|^Cells_|^Cytoplasm_"</span>)</pre></body></html></div>
</div>
<div id="calculate-treatment-profiles-and-predict-mechanism-of-action" class="section level1">
<h1 class="hasAnchor">
<a href="#calculate-treatment-profiles-and-predict-mechanism-of-action" class="anchor"></a>Calculate treatment profiles and predict mechanism-of-action</h1>
<p>We have selected features and normalized the data. We can now compute treatment profiles by averaging across replicates.</p>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="no">profiles</span> <span class="kw">&lt;-</span>
  <span class="kw pkg">cytominer</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/cytominer/man/aggregate.html">aggregate</a></span>(
    <span class="kw">population</span> <span class="kw">=</span> <span class="no">profiles</span>,
    <span class="kw">variables</span> <span class="kw">=</span> <span class="no">variables</span>,
    <span class="kw">strata</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Image_Metadata_Compound"</span>,
               <span class="st">"Image_Metadata_Concentration"</span>,
               <span class="st">"Image_Metadata_MoA"</span>),
    <span class="kw">operation</span> <span class="kw">=</span> <span class="st">"mean"</span>
  )

<span class="no">variables</span> <span class="kw">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">profiles</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_subset.html">str_subset</a></span>(<span class="st">"^Nuclei_|^Cells_|^Cytoplasm_"</span>)</pre></body></html></div>
<p>Letâ€™s visualize this data using t-SNE.</p>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="no">profiles</span> <span class="kw">%&lt;&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">Image_Metadata_Compound</span> <span class="kw">!=</span> <span class="st">"DMSO"</span>)

<span class="no">correlation</span> <span class="kw">&lt;-</span>
  <span class="no">profiles</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="fu"><a href="https://dplyr.tidyverse.org/reference/reexports.html">one_of</a></span>(<span class="no">variables</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span>()

<span class="no">mechanism</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="no">profiles</span>$<span class="no">Image_Metadata_MoA</span>)

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">123</span>)

<span class="no">df</span> <span class="kw">&lt;-</span>
  <span class="kw pkg">tibble</span><span class="kw ns">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/deprecated.html">as_data_frame</a></span>(
    <span class="kw pkg">tsne</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/tsne/man/tsne.html">tsne</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/dist.html">as.dist</a></span>(<span class="fl">1</span>-<span class="no">correlation</span>))
    ) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">mechanism</span> <span class="kw">=</span> <span class="no">mechanism</span>)</pre></body></html></div>
<pre><code>## Warning: `as_data_frame()` is deprecated as of tibble 2.0.0.
## Please use `as_tibble()` instead.
## The signature and semantics have changed, see `?as_tibble`.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_warnings()` to see where this warning was generated.</code></pre>
<pre><code>## Warning: The `x` argument of `as_tibble.matrix()` must have column names if `.name_repair` is omitted as of tibble 2.0.0.
## Using compatibility `.name_repair`.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_warnings()` to see where this warning was generated.</code></pre>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="no">p</span> <span class="kw">&lt;-</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="no">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">V1</span>, <span class="no">V2</span>, <span class="kw">color</span><span class="kw">=</span><span class="no">mechanism</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>() +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"t-SNE visualization of compound profiles"</span>)

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">p</span>)</pre></body></html></div>
<p><img src="predict_moa_files/figure-html/unnamed-chunk-13-1.png" width="768"></p>
<p>The data clusters into mechanisms quite nicely. Letâ€™s quantify this by evaluating how well we can predict mechanism-of-action by simply assigning a treatment the mechanism of its nearest neighbor. NOTE: A common mistake when analyzing this dataset is to not exclude other concentrations of the same compound when looking up the nearest neighbor. That is cheating! <code>mask</code> in the code below addresses this.</p>
<div class="sourceCode" id="cb22"><html><body><pre class="r"><span class="no">compound</span> <span class="kw">&lt;-</span> <span class="no">profiles</span>$<span class="no">Image_Metadata_Compound</span>

<span class="no">mask</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/outer.html">outer</a></span>(<span class="no">compound</span>, <span class="no">compound</span>, <span class="kw">FUN</span><span class="kw">=</span><span class="st">"!="</span>))

<span class="no">mask</span>[<span class="no">mask</span> <span class="kw">==</span> <span class="fl">0</span>] <span class="kw">&lt;-</span> -<span class="fl">Inf</span>

<span class="no">correlation_masked</span> <span class="kw">&lt;-</span> <span class="no">correlation</span> * <span class="no">mask</span>

<span class="no">prediction</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">correlation_masked</span>),
               <span class="kw">function</span>(<span class="no">i</span>) <span class="no">mechanism</span>[<span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span>(<span class="no">correlation_masked</span>[<span class="no">i</span>,],
                                           <span class="kw">decreasing</span> <span class="kw">=</span> <span class="fl">TRUE</span>)[<span class="fl">1</span>]])

<span class="no">confusion_matrix</span> <span class="kw">&lt;-</span> <span class="kw pkg">caret</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/caret/man/confusionMatrix.html">confusionMatrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="no">prediction</span>),
                                           <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="no">mechanism</span>))</pre></body></html></div>
<p>Whatâ€™s the classification accuracy?</p>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="kw pkg">tibble</span><span class="kw ns">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/deprecated.html">frame_data</a></span>(
  ~<span class="no">metric</span>, ~<span class="no">value</span>,
  <span class="st">"Accuracy"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"%.2f"</span>, <span class="no">confusion_matrix</span>$<span class="no">overall</span>[<span class="st">"Accuracy"</span>]),
  <span class="st">"95% CI"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"(%.2f, %.2f)"</span>, <span class="no">confusion_matrix</span>$<span class="no">overall</span><span class="kw">[[</span><span class="st">"AccuracyLower"</span>]],
                    <span class="no">confusion_matrix</span>$<span class="no">overall</span><span class="kw">[[</span><span class="st">"AccuracyUpper"</span>]])
  ) <span class="kw">%&gt;%</span>
  <span class="kw pkg">knitr</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(<span class="kw">digits</span> <span class="kw">=</span> <span class="fl">2</span>)</pre></body></html></div>
<pre><code>## Warning: `frame_data()` is deprecated as of lifecycle 2.0.0.
## Please use `tribble()` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_warnings()` to see where this warning was generated.</code></pre>
<table class="table">
<thead><tr class="header">
<th align="left">metric</th>
<th align="left">value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Accuracy</td>
<td align="left">0.82</td>
</tr>
<tr class="even">
<td align="left">95% CI</td>
<td align="left">(0.73, 0.89)</td>
</tr>
</tbody>
</table>
<p>What does the whole confusion matrix look like?</p>
<div class="sourceCode" id="cb25"><html><body><pre class="r"><span class="no">confusion_matrix</span>$<span class="no">table</span> <span class="kw">%&gt;%</span>
  <span class="kw pkg">knitr</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>()</pre></body></html></div>
<table class="table">
<thead><tr class="header">
<th></th>
<th align="right">Actin disruptors</th>
<th align="right">Aurora kinase inhibitors</th>
<th align="right">Cholesterol-lowering</th>
<th align="right">DNA damage</th>
<th align="right">DNA replication</th>
<th align="right">Eg5 inhibitors</th>
<th align="right">Epithelial</th>
<th align="right">Kinase inhibitors</th>
<th align="right">Microtubule destabilizers</th>
<th align="right">Microtubule stabilizers</th>
<th align="right">Protein degradation</th>
<th align="right">Protein synthesis</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Actin disruptors</td>
<td align="right">4</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td>Aurora kinase inhibitors</td>
<td align="right">0</td>
<td align="right">12</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td>Cholesterol-lowering</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">6</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td>DNA damage</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">8</td>
<td align="right">5</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td>DNA replication</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td>Eg5 inhibitors</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">6</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td>Epithelial</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">8</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td>Kinase inhibitors</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">5</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td>Microtubule destabilizers</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">6</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">12</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td>Microtubule stabilizers</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">8</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td>Protein degradation</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td>Protein synthesis</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">8</td>
</tr>
</tbody>
</table>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Tim Becker, Allen Goodman, Claire McQuin, Mohammad Rohban, Shantanu Singh.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
